Starting
Loaded Train
Loaded Val
Loaded Test
[Fri, 11 Aug 2023 16:09:29] INFO [bilstm_reg.py.<module>:204] Train Set:  5704 || Validation Set:   992 || Test Set:  1043
Device:  cuda
[Fri, 11 Aug 2023 16:09:32] INFO [bilstm_reg.py.<module>:221] Model Params Total:  7061595
[Fri, 11 Aug 2023 16:09:32] INFO [bilstm_reg.py.<module>:242] Training Epoch:     1
[Fri, 11 Aug 2023 16:09:32] INFO [bilstm_reg.py.<module>:244] Learning Rate:  0.0001000000
Training
/nfs_home/nallapar/rb-prof/src/models/regression/bilstm/depr_reg/bilstm_reg.py:76: UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_.
  torch.nn.init.xavier_uniform(m.weight)
/nfs_home/nallapar/rb-prof/src/models/regression/bilstm/depr_reg/bilstm_reg.py:78: UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_.
  torch.nn.init.xavier_uniform(m.weight_ih_l0)
/nfs_home/nallapar/rb-prof/src/models/regression/bilstm/depr_reg/bilstm_reg.py:79: UserWarning: nn.init.orthogonal is now deprecated in favor of nn.init.orthogonal_.
  torch.nn.init.orthogonal(m.weight_hh_l0)
/nfs_home/nallapar/rb-prof/src/models/regression/bilstm/depr_reg/bilstm_reg.py:80: UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_.
  torch.nn.init.xavier_uniform(m.weight_ih_l0_reverse)
/nfs_home/nallapar/rb-prof/src/models/regression/bilstm/depr_reg/bilstm_reg.py:81: UserWarning: nn.init.orthogonal is now deprecated in favor of nn.init.orthogonal_.
  torch.nn.init.orthogonal(m.weight_hh_l0_reverse)
/nfs_home/nallapar/rb-prof/src/models/regression/bilstm/depr_reg/bilstm_reg.py:83: UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_.
  torch.nn.init.xavier_uniform(m.weight)
Traceback (most recent call last):
  File "/nfs_home/nallapar/rb-prof/src/models/regression/bilstm/depr_reg/bilstm_reg.py", line 247, in <module>
    train_loss, train_pr, train_sr =  train(model, train_dataloader, bs, device, criterion, mult_factor, loss_mult_factor, optimizer, logger, epoch, epochs)
  File "/nfs_home/nallapar/rb-prof/src/models/regression/bilstm/depr_reg/model_utils.py", line 257, in train
    outputs = model(inputs, condition_value)
  File "/nfs_home/nallapar/rb-prof/bio_embeds/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/nfs_home/nallapar/rb-prof/src/models/regression/bilstm/depr_reg/model_utils.py", line 211, in forward
    if depr_vec[i] == 1:
RuntimeError: Boolean value of Tensor with more than one value is ambiguous